{"version":3,"sources":["../src/client.js"],"names":["Client","apiKey","apiSecret","key","secret","_request","minWait","__request","bind","path","method","toLowerCase","auth","send","file","body","req","field","Array","isArray","forEach","attach","f","pause","ms","Promise","setTimeout","resolve","fn","between","last","args","now","Date","wait","Math","max","then"],"mappings":";;;;;;;;AAAA;;;;AAEA;;;;;;;;;;IAEqBA,M;AAEnB,kBAAaC,MAAb,EAAqBC,SAArB,EAAgC;AAAA;;AAC9B,SAAKC,GAAL,GAAWF,MAAX;AACA,SAAKG,MAAL,GAAcF,SAAd;AACA,SAAKG,QAAL,GAAgBC,QAAQ,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAR,EAAmC,IAAnC,CAAhB;AACD;;;;;8CAEgBC,I,EAAsB;AAAA;;AAAA,YAAhBC,MAAgB,uEAAP,KAAO;;AACrC,eAAO;AAAA,iBAAM,qBAAQA,OAAOC,WAAP,EAAR,EAA8B,sBAAWF,IAAzC,EACVG,IADU,CACL,MAAKT,GADA,EACK,MAAKC,MADV,CAAN;AAAA,SAAP;AAED,O;;;;;;;;;;wBAEU;AAAA;;AACT,aAAO;AACLS;AAAA,wCAAM,kBAA6B;AAAA,gBAApBC,IAAoB,SAApBA,IAAoB;AAAA,gBAAXC,IAAW;;AACjC,gBAAMC,MAAM,CAAC,MAAM,OAAKX,QAAL,CAAc,QAAd,EAAwB,MAAxB,CAAP,GAAZ;AACAW,gBAAIC,KAAJ,CAAUF,IAAV;AACA,gBAAIG,MAAMC,OAAN,CAAcL,IAAd,CAAJ,EAAyBA,KAAKM,OAAL,CAAa;AAAA,qBAAKJ,IAAIK,MAAJ,WAAqBC,CAArB,CAAL;AAAA,aAAb,EAAzB,KACKN,IAAIK,MAAJ,CAAW,MAAX,EAAmBP,IAAnB;AACL,mBAAOE,GAAP;AACD,WAND;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADK,OAAP;AASD;;;;;;kBAvBkBhB,M;;;AA2BrB,SAASuB,KAAT,GAAwB;AAAA,MAARC,EAAQ,uEAAH,CAAG;;AACtB,SAAO,IAAIC,OAAJ,CAAY;AAAA,WAAWC,WAAWC,OAAX,EAAoBH,EAApB,CAAX;AAAA,GAAZ,CAAP;AACD;;AAED,SAASlB,OAAT,CAAkBsB,EAAlB,EAAsBC,OAAtB,EAA+B;AAC7B,MAAIC,OAAO,CAAX;;AAEA,SAAO,YAAa;AAAA,sCAATC,IAAS;AAATA,UAAS;AAAA;;AAClB,QAAMC,MAAMC,KAAKD,GAAL,EAAZ;AACA,QAAME,OAAOC,KAAKC,GAAL,CAAS,CAAT,EAAYP,UAAUG,GAAV,GAAgBF,IAA5B,CAAb;AACAA,WAAOE,MAAME,IAAb;AACA,WAAOX,MAAMW,IAAN,EAAYG,IAAZ,CAAiB;AAAA,aAAMT,oBAAMG,IAAN,CAAN;AAAA,KAAjB,CAAP;AACD,GALD;AAMD","file":"client.js","sourcesContent":["import request from 'superagent';\n\nimport { BASE_URL } from './constants.js';\n\nexport default class Client {\n\n  constructor (apiKey, apiSecret) {\n    this.key = apiKey;\n    this.secret = apiSecret;\n    this._request = minWait(this.__request.bind(this), 2000);\n  }\n\n  async __request (path, method = 'GET') {\n    return () => request[method.toLowerCase()](BASE_URL + path)\n      .auth(this.key, this.secret);\n  }\n\n  get Fax () {\n    return {\n      send: async ({ file, ...body }) => {\n        const req = (await this._request('/faxes', 'POST'))();\n        req.field(body);\n        if (Array.isArray(file)) file.forEach(f => req.attach(`file[]`, f));\n        else req.attach('file', file);\n        return req;\n      }\n    };\n  }\n\n}\n\nfunction pause (ms = 0) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nfunction minWait (fn, between) {\n  let last = 0;\n\n  return (...args) => {\n    const now = Date.now();\n    const wait = Math.max(0, between - now + last);\n    last = now + wait;\n    return pause(wait).then(() => fn(...args));\n  };\n}\n"]}